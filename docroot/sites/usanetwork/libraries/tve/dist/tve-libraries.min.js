

//Source: ../../libraries/tve/lib/jquery.waitforimages.min.js
/*! waitForImages jQuery Plugin 2013-07-20 */
!function(a){var b="waitForImages";a.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage","cursor"]},a.expr[":"].uncached=function(b){if(!a(b).is('img[src!=""]'))return!1;var c=new Image;return c.src=b.src,!c.complete},a.fn.waitForImages=function(c,d,e){var f=0,g=0;if(a.isPlainObject(arguments[0])&&(e=arguments[0].waitForAll,d=arguments[0].each,c=arguments[0].finished),c=c||a.noop,d=d||a.noop,e=!!e,!a.isFunction(c)||!a.isFunction(d))throw new TypeError("An invalid callback was supplied.");return this.each(function(){var h=a(this),i=[],j=a.waitForImages.hasImageProperties||[],k=/url\(\s*(['"]?)(.*?)\1\s*\)/g;e?h.find("*").addBack().each(function(){var b=a(this);b.is("img:uncached")&&i.push({src:b.attr("src"),element:b[0]}),a.each(j,function(a,c){var d,e=b.css(c);if(!e)return!0;for(;d=k.exec(e);)i.push({src:d[2],element:b[0]})})}):h.find("img:uncached").each(function(){i.push({src:this.src,element:this})}),f=i.length,g=0,0===f&&c.call(h[0]),a.each(i,function(e,i){var j=new Image;a(j).on("load."+b+" error."+b,function(a){return g++,d.call(i.element,g,f,"load"==a.type),g==f?(c.call(h[0]),!1):void 0}),j.src=i.src})})}}(jQuery);;

//Source: ../../libraries/tve/lib/jquery.ba-throttle-debounce.min.js
/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(b,c){var $=b.jQuery||b.Cowboy||(b.Cowboy={}),a;$.throttle=a=function(e,f,j,i){var h,d=0;if(typeof f!=="boolean"){i=j;j=f;f=c}function g(){var o=this,m=+new Date()-d,n=arguments;function l(){d=+new Date();j.apply(o,n)}function k(){h=c}if(i&&!h){l()}h&&clearTimeout(h);if(i===c&&m>e){l()}else{if(f!==true){h=setTimeout(i?k:l,i===c?e-m:e)}}}if($.guid){g.guid=j.guid=j.guid||$.guid++}return g};$.debounce=function(d,e,f){return f===c?a(d,e,false):a(d,f,e!==false)}})(this);;

//Source: ../../libraries/tve/.tmp/libraries.min.js
!function(a,b,c){var d=window.matchMedia;"undefined"!=typeof module&&module.exports?module.exports=c(d):"function"==typeof define&&define.amd?define(function(){return b[a]=c(d)}):b[a]=c(d)}("enquire",this,function(a){"use strict";function b(a,b){var c,d=0,e=a.length;for(d;e>d&&(c=b(a[d],d),c!==!1);d++);}function c(a){return"[object Array]"===Object.prototype.toString.apply(a)}function d(a){return"function"==typeof a}function e(a){this.options=a,!a.deferSetup&&this.setup()}function f(b,c){this.query=b,this.isUnconditional=c,this.handlers=[],this.mql=a(b);var d=this;this.listener=function(a){d.mql=a,d.assess()},this.mql.addListener(this.listener)}function g(){if(!a)throw new Error("matchMedia not present, legacy browsers require a polyfill");this.queries={},this.browserIsIncapable=!a("only all").matches}return e.prototype={setup:function(){this.options.setup&&this.options.setup(),this.initialised=!0},on:function(){!this.initialised&&this.setup(),this.options.match&&this.options.match()},off:function(){this.options.unmatch&&this.options.unmatch()},destroy:function(){this.options.destroy?this.options.destroy():this.off()},equals:function(a){return this.options===a||this.options.match===a}},f.prototype={addHandler:function(a){var b=new e(a);this.handlers.push(b),this.matches()&&b.on()},removeHandler:function(a){var c=this.handlers;b(c,function(b,d){return b.equals(a)?(b.destroy(),!c.splice(d,1)):void 0})},matches:function(){return this.mql.matches||this.isUnconditional},clear:function(){b(this.handlers,function(a){a.destroy()}),this.mql.removeListener(this.listener),this.handlers.length=0},assess:function(){var a=this.matches()?"on":"off";b(this.handlers,function(b){b[a]()})}},g.prototype={register:function(a,e,g){var h=this.queries,i=g&&this.browserIsIncapable;return h[a]||(h[a]=new f(a,i)),d(e)&&(e={match:e}),c(e)||(e=[e]),b(e,function(b){d(b)&&(b={match:b}),h[a].addHandler(b)}),this},unregister:function(a,b){var c=this.queries[a];return c&&(b?c.removeHandler(b):(c.clear(),delete this.queries[a])),this}},new g}),function(){angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(a){var b=function(a,b,c){b.removeClass("collapse"),b.css({height:c});b[0].offsetWidth;b.addClass("collapse")};return{link:function(c,d,e){var f,g=!0;c.$watch(e.collapse,function(a){a?k():j()});var h,i=function(b){return h&&h.cancel(),h=a(d,b),h.then(function(){h=void 0},function(){h=void 0}),h},j=function(){g?(g=!1,f||(b(c,d,"auto"),d.addClass("in"))):i({height:d[0].scrollHeight+"px"}).then(function(){f||(b(c,d,"auto"),d.addClass("in"))}),f=!1},k=function(){f=!0,d.removeClass("in"),g?(g=!1,b(c,d,0)):(b(c,d,d[0].scrollHeight+"px"),i({height:"0"}))}}}}])}(),function(){angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(a,b,c){this.groups=[],this.closeOthers=function(d){var e=angular.isDefined(b.closeOthers)?a.$eval(b.closeOthers):c.closeOthers;e&&angular.forEach(this.groups,function(a){a!==d&&(a.isOpen=!1)})},this.addGroup=function(a){var b=this;this.groups.push(a),a.$on("$destroy",function(){b.removeGroup(a)})},this.removeGroup=function(a){var b=this.groups.indexOf(a);-1!==b&&this.groups.splice(this.groups.indexOf(a),1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,template:'<div class="accordion" data-ng-transclude></div>'}}).directive("accordionGroup",["$parse",function(a){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,template:'<div class="accordionGroup"><div class="accordionHeading" data-ng-class="{opened: isOpen, collapsible: collapsible}"><a class="accordionToggle" ng-click="isOpen = !isOpen" accordion-transclude="heading">{{heading}}</a></div><div class="accordionBody" collapse="!isOpen"><div class="accordionInner" data-ng-transclude></div></div></div>',scope:{heading:"@"},controller:function(){this.setHeading=function(a){this.heading=a}},link:function(b,c,d,e){var f,g;e.addGroup(b),b.isOpen=!1,d.isOpen&&(f=a(d.isOpen),g=f.assign,b.$parent.$watch(f,function(a){b.isOpen=!!a})),b.$watch("isOpen",function(a){a&&e.closeOthers(b),g&&g(b.$parent,a)})}}}]).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",compile:function(a,b,c){return function(a,b,d,e){e.setHeading(c(a,function(){}))}}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(a,b,c,d){a.$watch(function(){return d[c.accordionTransclude]},function(a){a&&(b.html(""),b.append(a))})}}})}(),angular.module("ui.event",[]).directive("uiEvent",["$parse",function(a){return function(b,c,d){var e=b.$eval(d.uiEvent);angular.forEach(e,function(d,e){var f=a(d);c.bind(e,function(a){var c=Array.prototype.slice.call(arguments);c=c.splice(1),f(b,{$event:a,$params:c}),b.$$phase||b.$apply()})})}}]),angular.module("ui.keypress",[]).factory("keypressHelper",["$parse",function(a){var b={8:"backspace",9:"tab",13:"enter",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete"},c=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};return function(d,e,f,g){var h,i=[];h=e.$eval(g["ui"+c(d)]),angular.forEach(h,function(b,c){var d,e;e=a(b),angular.forEach(c.split(" "),function(a){d={expression:e,keys:{}},angular.forEach(a.split("-"),function(a){d.keys[a]=!0}),i.push(d)})}),f.bind(d,function(a){var c=!(!a.metaKey||a.ctrlKey),f=!!a.altKey,g=!!a.ctrlKey,h=!!a.shiftKey,j=a.keyCode;"keypress"===d&&!h&&j>=97&&122>=j&&(j-=32),angular.forEach(i,function(d){var i=d.keys[b[j]]||d.keys[j.toString()],k=!!d.keys.meta,l=!!d.keys.alt,m=!!d.keys.ctrl,n=!!d.keys.shift;i&&k===c&&l===f&&m===g&&n===h&&e.$apply(function(){d.expression(e,{$event:a})})})})}}]),angular.module("ui.keypress").directive("uiKeydown",["keypressHelper",function(a){return{link:function(b,c,d){a("keydown",b,c,d)}}}]),angular.module("ui.keypress").directive("uiKeypress",["keypressHelper",function(a){return{link:function(b,c,d){a("keypress",b,c,d)}}}]),angular.module("ui.keypress").directive("uiKeyup",["keypressHelper",function(a){return{link:function(b,c,d){a("keyup",b,c,d)}}}]);var timerModule=angular.module("timer",[]).directive("timer",["$compile",function(a){return{restrict:"EAC",replace:!1,scope:{interval:"=interval",startTimeAttr:"=startTime",endTimeAttr:"=endTime",countdownattr:"=countdown",finishCallback:"&finishCallback",autoStart:"&autoStart",maxTimeUnit:"="},controller:["$scope","$element","$attrs","$timeout",function(b,c,d,e){function f(){b.timeoutId&&clearTimeout(b.timeoutId)}function g(){b.maxTimeUnit&&"day"!==b.maxTimeUnit?"second"===b.maxTimeUnit?(b.seconds=Math.floor(b.millis/1e3),b.minutes=0,b.hours=0,b.days=0,b.months=0,b.years=0):"minute"===b.maxTimeUnit?(b.seconds=Math.floor(b.millis/1e3%60),b.minutes=Math.floor(b.millis/6e4),b.hours=0,b.days=0,b.months=0,b.years=0):"hour"===b.maxTimeUnit?(b.seconds=Math.floor(b.millis/1e3%60),b.minutes=Math.floor(b.millis/6e4%60),b.hours=Math.floor(b.millis/36e5),b.days=0,b.months=0,b.years=0):"month"===b.maxTimeUnit?(b.seconds=Math.floor(b.millis/1e3%60),b.minutes=Math.floor(b.millis/6e4%60),b.hours=Math.floor(b.millis/36e5%24),b.days=Math.floor(b.millis/36e5/24%30),b.months=Math.floor(b.millis/36e5/24/30),b.years=0):"year"===b.maxTimeUnit&&(b.seconds=Math.floor(b.millis/1e3%60),b.minutes=Math.floor(b.millis/6e4%60),b.hours=Math.floor(b.millis/36e5%24),b.days=Math.floor(b.millis/36e5/24%30),b.months=Math.floor(b.millis/36e5/24/30%12),b.years=Math.floor(b.millis/36e5/24/365)):(b.seconds=Math.floor(b.millis/1e3%60),b.minutes=Math.floor(b.millis/6e4%60),b.hours=Math.floor(b.millis/36e5%24),b.days=Math.floor(b.millis/36e5/24),b.months=0,b.years=0),b.secondsS=1==b.seconds?"":"s",b.minutesS=1==b.minutes?"":"s",b.hoursS=1==b.hours?"":"s",b.daysS=1==b.days?"":"s",b.monthsS=1==b.months?"":"s",b.yearsS=1==b.years?"":"s",b.sseconds=b.seconds<10?"0"+b.seconds:b.seconds,b.mminutes=b.minutes<10?"0"+b.minutes:b.minutes,b.hhours=b.hours<10?"0"+b.hours:b.hours,b.ddays=b.days<10?"0"+b.days:b.days,b.mmonths=b.months<10?"0"+b.months:b.months,b.yyears=b.years<10?"0"+b.years:b.years}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),b.autoStart=d.autoStart||d.autostart,c.append(0===c.html().trim().length?a("<span>{{millis}}</span>")(b):a(c.contents())(b)),b.$watch("countdownattr",function(a){a&&b.start()}),b.startTime=null,b.endTime=null,b.timeoutId=null,b.countdown=b.countdownattr&&parseInt(b.countdownattr,10)>=0?parseInt(b.countdownattr,10):void 0,b.isRunning=!1,b.$on("timer-start",function(){b.start()}),b.$on("timer-resume",function(){b.resume()}),b.$on("timer-stop",function(){b.stop()}),b.$on("timer-clear",function(){b.clear()}),b.$on("timer-set-countdown",function(a,c){b.countdown=c}),b.start=c[0].start=function(){b.startTime=b.startTimeAttr?new Date(b.startTimeAttr):new Date,b.endTime=b.endTimeAttr?new Date(b.endTimeAttr):null,b.countdown||(b.countdown=b.countdownattr&&parseInt(b.countdownattr,10)>0?parseInt(b.countdownattr,10):void 0),f(),h(),b.isRunning=!0},b.resume=c[0].resume=function(){f(),b.countdownattr&&(b.countdown+=1),b.startTime=new Date-(b.stoppedTime-b.startTime),h(),b.isRunning=!0},b.stop=b.pause=c[0].stop=c[0].pause=function(){var a=b.timeoutId;b.clear(),b.$emit("timer-stopped",{timeoutId:a,millis:b.millis,seconds:b.seconds,minutes:b.minutes,hours:b.hours,days:b.days})},b.clear=c[0].clear=function(){b.stoppedTime=new Date,f(),b.timeoutId=null,b.isRunning=!1},c.bind("$destroy",function(){f(),b.isRunning=!1}),b.countdownattr?(b.millis=1e3*b.countdownattr,b.addCDSeconds=c[0].addCDSeconds=function(a){b.countdown+=a,b.$digest(),b.isRunning||b.start()},b.$on("timer-add-cd-seconds",function(a,c){e(function(){b.addCDSeconds(c)})}),b.$on("timer-set-countdown-seconds",function(a,c){b.isRunning||b.clear(),b.countdown=c,b.millis=1e3*c,g()})):b.millis=0,g();var h=function(){b.millis=new Date-b.startTime;var a=b.millis%1e3,c=100>a?a:0;return b.endTimeAttr&&(b.millis=b.endTime-new Date,c=b.interval-b.millis%1e3),b.countdownattr&&(b.millis=1e3*b.countdown),b.millis<0?(b.stop(),b.millis=0,g(),void(b.finishCallback&&b.$eval(b.finishCallback))):(g(),b.timeoutId=setTimeout(function(){h(),b.$digest()},b.interval-c),b.$emit("timer-tick",{timeoutId:b.timeoutId,millis:b.millis}),void(b.countdown>0?b.countdown--:b.countdown<=0&&(b.stop(),b.finishCallback&&b.$eval(b.finishCallback))))};(void 0===b.autoStart||b.autoStart===!0)&&b.start()}]}}]);"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports=timerModule),function(a,b){"use strict";Date.now=Date.now||function(){return+new Date},b.requestAnimationFrame=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||function(a){b.setTimeout(a,1e3/60)},b.cancelAnimationFrame=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.mozCancelAnimationFrame||b.clearTimeout,b.tve=b.tve||{},a.module("tve.filters",[]),a.module("tve.controllers",[]),a.module("tve.services",[]),a.module("tve.directives",[])}(angular,this),function(a){"use strict";a.module("tve.filters").filter("trackLink",[function(){return function(){var a=":",b=Array.prototype.slice.call(arguments,1).join(a);try{window.linkTrkCookie?linkTrkCookie(b):window.s&&s.c_w&&s.c_w("linktrk",b,0)}catch(c){console.error(c.stack?c.stack:c.message)}}}])}(angular),function(a){"use strict";a.module("tve.directives").directive("ngBindHtmlUnsafe",[function(){return function(a,b,c){b.addClass("ng-binding").data("$binding",c.ngBindHtmlUnsafe),a.$watch(c.ngBindHtmlUnsafe,function(a){b.html(a||"")})}}])}(angular),function(a,b){a.module("tve.directives").directive("tveReflow",[function(){return{link:function(a,c){var d=b.browser;(!d||d.msie)&&setTimeout(function(){c.css("opacity",c.css("opacity"))},0)}}}])}(angular,jQuery),function(a){a.module("tve.directives").directive("tveScreenSize",["$window","helper",function(b,c){return{link:function(d){var e=function(){d.$apply(function(){d.mobileResolutionFlag=!c.isMobile()})};d.mobileResolutionFlag=!c.isMobile(),a.element(b).bind("resize.breakpoint",c.throttle(100,e))}}}])}(angular),function(a,b,c,d){"use strict";a.module("tve.directives").directive("tvePlayer",["$sce","authService",function(c,d){return{replace:!1,template:'<iframe data-ng-src="{{src}}" src="about:blank" id="{{id}}" allowfullscreen="" frameborder="0"></iframe>',require:"^tvePlayerContainer",scope:!0,compile:function(e,f){var g=f;return function(e){function f(a){e.src=c.trustAsResourceUrl(g.src+"?"+h(a.isAuthenticated&&a.mvpdId))}function h(c){var d={autoPlay:!0};return a.forEach(i,function(a){a.attrName in g&&(d[a.key]=g[a.attrName])}),c&&(d[j]=c),b.param(d)}var i=[{attrName:"mbr",key:"mbr"},{attrName:"fwSiteSection",key:"FWsiteSection"}],j="MVPDid";e.id=g.id,d.promise.then(f)}}}}]).directive("tvePlayerContainer",["$rootScope","authService","tveAuthConfig","tveConfig","helper","tveModal",function(e,f,g,h,i,j){return{scope:!0,controller:["$scope",function(a){this.isEntitled=function(){return a.isEntitled}}],link:function(e,k,l){function m(){e.showAssetDetails=!1,e.showCompanionAdd=!0}function n(){e.showAssetDetails=!0,e.showCompanionAdd=!1}function o(){R=!0,S.show(),V.show(),T.hide()}function p(){R||(S.hide(),T.hide())}function q(){return"auth"==l.entitlement?void 0!=Drupal.settings.tve_cookie_detection?!e.isMobile&&f.isAuthenticated()&&Drupal.settings.tve_cookie_detection.status:!e.isMobile&&f.isAuthenticated():!e.isMobile}function r(){e.showLivePlayerSlateTimer=setInterval(function(){s()},G)}function s(){var a=1e3,c=Drupal.settings.refreshSlateDisplayTime,d=Date.now(),f=Math.round(d/a);f>=c&&(b("#"+h.PLAYER_ID).remove(),e.$apply(function(){e.isLivePlayerRefreshSlate=!0}),clearInterval(e.showLivePlayerSlateTimer))}function t(){"undefined"==typeof I.controller.iframe&&I.bind(h.PLAYER_ID),u(),I.controller.addEventListener("auth_token_failed",y),I.controller.addEventListener("auth_success",A),I.controller.addEventListener("companion_ad",z),I.controller.addEventListener("OnMediaStart",w),I.controller.addEventListener("OnShowProviderPicker",v),I.controller.addEventListener("OnMediaPlaying",x)}function u(){I.controller.setVariable({kuid:i.storage.get("kxuser"),ksg:i.storage.get("kxsegs")})}function v(){e.$apply(function(){b.cookie(g.cookies.NBCU_USER,"",{expires:-1,path:Drupal.settings.basePath}),f.openLoginModal()})}function w(a){var b=a&&a.data&&a.data.baseClip;if(b&&b.isAd?(!L&&Drupal.settings.tve_player.vod.lb_ad_status||L&&Drupal.settings.tve_player.live.lb_ad_status)&&p():e.$apply(function(){K||n()}),!L&&b){var c=a.data;P={contentId:b.contentID,duration:c.mediaLength}}}function x(a){a.data}function y(a){function c(c){b("#"+h.PLAYER_ID).remove(),e.isAuthZError=!0,e.message=c&&B(d,c)||b.trim(a.data.reasonid)||B(d,Drupal.settings.adobePass.errorMessages),e.$apply()}var d=a.data.message;f.getSelectedProvider().then(function(a){c(a)},function(){c(null)}),J.authzTrack(!1,{mvpd_id:O.mvpdId})}function z(a){var c=a.data.holderId,d=document.getElementById(c);Q&&i.toBoolean(c.match(H))&&(U.html(a.data.message),o()),d&&~c.indexOf(F)&&(b(d).html(a.data.message),K?e.showCompanionAdd=!0:m(),e.$digest())}function A(){J.authzTrack(!0,{mvpd_id:O.mvpdId})}function B(a,b){var c="";if(b)switch(a){case"User not Authorized Error":c=b.authorized_err;break;case"Generic Authorization Error":c=b.generic_err;break;case"Internal Authorization Error":c=b.internal_err}return c}var C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V;(I=d.$pdk)&&(C="auth",D="728",E="970",F="300",G=3e4,H=new RegExp(["ad_(",D,"|",E,")x\\d{2,3}_\\d{1}"].join(""),"gi"),J=c.analytics?c.analytics:{authzTrack:a.noop},K=i.toBoolean(l.largePlayer),L=i.toBoolean(l.live),M=l.mpxId,N=!L&&M&&M.split("/").pop(),Q=i.toBoolean(l.leaderboardAdsEnabled),T=b("#dart-tag-wrapper"),S=b(".tve-leaderboard-ads"),V=b("#leaderboard-ads-area-wrapper"),U=b("#leaderboard-ads-area"),R=!1,e.isEntitled=l.entitlement===C,e.isMobile=i.device.isMobile,e.showPlayer=q(),e.showLeaderboard=!0,e.showDartAdd=!0,e.showLeaderboardAdd=!1,e.showCompanionAdd=!1,e.showAssetDetails=!0,e.withHiddenAsset=!1,e.showWatchwithSideCar=!1,e.hideSideCarErrorMessage=!1,e.isLivePlayerRefreshSlate=!1,e.showLivePlayerSlateTimer=null,e.user={isAuthenticated:f.isAuthenticated()},f.promise.then(function(a){O=a,e.user.isAuthenticated=a.isAuthenticated,Drupal.settings.enableRefreshSlate&&e.showPlayer&&!a.isAuthenticated&&r(),(e.showPlayer=q())&&setTimeout(function(){"undefined"!=typeof c.watchwith&&c.watchwith.loadSideCar(),t()},0)}),e.openLoginWindow=f.openLoginModal,e.play=function(){e.previouslyWatched=null,I.controller.clickPlayButton(!0)},e.showWatchwithSidecar=function(){e.showWatchwithSideCar=!0},e.showAboutSection=function(){e.showWatchwithSideCar=!1},c.watchwith&&(c.watchwith.showSideCarTabs=function(){f.promise.then(function(){q()&&(e.showSideCarTabs=!0,e.hideSideCarErrorMessage=!0,e.showWatchwithSideCar=!0)})}),void 0!=Drupal.settings.tve_cookie_detection&&0==Drupal.settings.tve_cookie_detection.status&&"auth"==l.entitlement&&f.isAuthenticated()&&j.open({controller:"ThirdPartyCookieCtrl",windowClass:"thirdPartyCookieNotify tveModal tveModalBx",templateUrl:"third-party-cookie-notification.html",keyboard:!0,backdrop:"static"}))}}}])}(angular,jQuery,tve,this),function(a,b,c,d){"use strict";a.module("tve.directives").directive("tvePageAuthzPlayer",["$rootScope","$sce","$timeout","authService","$cookies","tveAuthConfig",function(c,d,e,f,g,h){return{replace:!1,template:'<iframe data-ng-src="{{src}}" src="about:blank" id="{{id}}" allowfullscreen="" frameborder="0"></iframe>',require:"^tvePageAuthzPlayerContainer",scope:!0,compile:function(f,i){var j=i;return function(f,i,k,l){function m(){var a="undefined"!=typeof g[q.USERSELECTEDMVPD]?g[q.USERSELECTEDMVPD]:"";f.src=d.trustAsResourceUrl(j.src+"?"+n(a)+"#playerurl="+location.href),e(function(){c.$broadcast("forceImagesLoading")},r)}function n(c){var d={autoPlay:!f.isEntitled};return a.forEach(o,function(a){a.attrName in j&&(d[a.key]=j[a.attrName])}),c&&(d[p]=c),b.param(d)}var o=[{attrName:"mbr",key:"mbr"},{attrName:"fwSiteSection",key:"FWsiteSection"}],p="MVPDid",q=h.cookies,r=5e3;f.id=j.id,e(function(){m()}),l.setReleaseURL(j.releaseUrl)}}}}]).directive("tvePageAuthzPlayerContainer",["$rootScope","authService","tveAuthConfig","tveConfig","helper","tveModal","$timeout","$interval","schedule",function(e,f,g,h,i,j,k,l,m){return{scope:!0,controller:["$scope","$q","$http",function(a,b,c){function d(){return c.get(i.getRelativePath(h.path.WIDGET_JSON+Drupal.settings.tve_widgets.live.embargoed_content.widget),{params:{no_render:1,timezone:a.timezone}})}function e(){return c.get(i.getRelativePath(h.path.WIDGET_JSON+"live"),{params:{no_render:1}})}function g(){e().then(function(a){a&&a.data&&(Drupal.settings.refreshSlateDisplayTime=a.data.data.refresh_slate_display_time,Drupal.settings.refreshSlateTitle=a.data.data.refresh_slate_title,Drupal.settings.refreshSlateSignInText=a.data.data.refresh_slate_sign_in_text)})}function j(){var b=60*Drupal.settings.refreshSlateDisplayInterval*1e3;a.updateLivePlayerSlateTimer=l(function(){g()},b)}function k(){var b=a.live.items[0];p(),b.embargoed?o():a.isShowingProposedContent=!1}function n(){switch(Drupal.settings.tve_widgets.live.embargoed_content.source){case a.embargoedContentUseCases.off:a.isShowingProposedContent=!1;break;case a.embargoedContentUseCases.inband:a.user.isAuthenticated||k();break;case a.embargoedContentUseCases.schedule:k()}}function o(){d().then(function(b){b&&b.data&&(a.isShowingProposedContent=!0,a.live=b.data.data.live.items[0],a.live.thumbnail=b.data.data.live.live_program_thumbnail_url,a.assets_title=b.data.data.assets_title,a.proposedShows=b.data.data.assets,a.timeLeft=Math.round((new Date(a.live.start_time*a.incr)-Date.now())/a.incr))})}function p(){a.$on(h.LIVE_SCHEDULE_UPDATE,function(){var b=m.getLive();b.now.embargoed?o():a.isShowingProposedContent=!1})}a.embargoedContentUseCases={off:"",inband:"inband",schedule:"schedule"},a.isShowingProposedContent=!1,a.incr=1e3,a.updateLivePlayerSlateTimer=null,b.all([f.promise,m.promise]).then(function(b){a.user=b[0],a.live=b[1].live,a.timezone=b[1].timezone,Drupal.settings.tve_widgets.live&&Drupal.settings.tve_widgets.live.embargoed_content&&n()}),Drupal.settings.enableRefreshSlate&&Drupal.settings.refreshSlateDisplayInterval>0&&j(),this.hideProposedContent=function(){a.isShowingProposedContent=!1},this.isEntitled=function(){return a.isEntitled},this.setReleaseURL=function(b){a.releaseUrl=b}}],link:function(m,n,o){function p(){var a="TV-14",b=Drupal.settings.adobePass.adobePassResourceId,d=['<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">',"<channel>","<title>",b,"</title>","<item>","<title><![CDATA[",ab,"]]></title>","<guid>",bb,"</guid>",'<media:rating scheme="urn:mpaa">',_||a,"</media:rating>","</item>","</channel>","</rss>"].join("");c.adobePass.getAuthorization(d,function(a,b){a?(cb=encodeURIComponent(b.token),F()):D(b)})}function q(){m.showAssetDetails=!1,m.showCompanionAdd=!0}function r(){m.showAssetDetails=!0,m.showCompanionAdd=!1}function s(){W=!0,X.show(),$.show(),Y.hide()}function t(){W||(X.hide(),Y.hide())}function u(){return m.isMobile?!1:"auth"!=o.entitlement?!0:f.isAuthenticated()&&("undefined"==typeof Drupal.settings.tve_cookie_detection||Drupal.settings.tve_cookie_detection.status)?!0:!1}function v(){m.showLivePlayerSlateTimer=setInterval(function(){w()},L)}function w(){var a=1e3,c=Drupal.settings.refreshSlateDisplayTime,d=Date.now(),e=Math.round(d/a);e>=c&&(b("#"+h.PLAYER_ID).remove(),m.$apply(function(){m.isLivePlayerRefreshSlate=!0,m.refreshSlateTitle=Drupal.settings.refreshSlateTitle,m.refreshSlateSignInText=Drupal.settings.refreshSlateSignInText}),clearInterval(m.showLivePlayerSlateTimer),l.cancel(m.updateLivePlayerSlateTimer))}function x(){"undefined"==typeof N.controller.iframe&&N.bind(h.PLAYER_ID),y(),N.controller.addEventListener("OnPlayerLoaded",function(){"free"==o.entitlement}),Drupal.settings.tve_widgets.live&&Drupal.settings.tve_widgets.live.embargoed_content.source==m.embargoedContentUseCases.schedule&&m.$watch("isShowingProposedContent",function(a,b){a!==b&&N.controller.mute(m.isShowingProposedContent)}),N.controller.addEventListener("companion_ad",E),N.controller.addEventListener("OnMediaStart",B),N.controller.addEventListener("OnShowProviderPicker",z),N.controller.addEventListener("OnMediaPlaying",C),N.controller.addEventListener("OnShowPlayOverlay",A)}function y(){N.controller.setVariable({kuid:i.storage.get("kxuser"),ksg:i.storage.get("kxsegs")})}function z(){m.$apply(function(){b.cookie(g.cookies.NBCU_USER,"",{expires:-1,path:Drupal.settings.basePath}),f.openLoginModal()})}function A(){null!=cb&&N.controller.clickPlayButton()}function B(a){var b=a&&a.data&&a.data.baseClip;if(N.controller.removeEventListener("OnShowPlayOverlay",A),e.$broadcast("forceImagesLoading"),m.$apply(function(){m.isPlayerLoading=!1}),b&&b.isAd?(!Q&&Drupal.settings.tve_player.vod.lb_ad_status||Q&&Drupal.settings.tve_player.live.lb_ad_status)&&t():m.$apply(function(){P||r()}),!Q&&b){var c=a.data;U={contentId:b.contentID,duration:c.mediaLength}}}function C(a){a.data}function D(a){function c(c){b("#"+h.PLAYER_ID).remove(),m.isAuthZError=!0,m.message=c&&G(d,c)||b.trim(a.requestErrorDetails)||G(d,Drupal.settings.adobePass.errorMessages),m.$apply()}var d=a.requestErrorCode;m.isPlayerLoading=!1,f.getSelectedProvider().then(function(a){c(a)},function(){c(null)}),O.authzTrack(!1,{mvpd_id:T.mvpdId})}function E(a){var c=a.data.holderId,d=document.getElementById(c);V&&i.toBoolean(c.match(M))&&(Z.html(a.data.message),s()),d&&~c.indexOf(K)&&(b(d).html(a.data.message),P?m.showCompanionAdd=!0:q(),m.$digest())}function F(){N.controller.setToken(cb,"authToken"),!m.isLive,A(),O.authzTrack(!0,{mvpd_id:T.mvpdId})}function G(a,b){var c="";if(b)switch(a){case"User not Authorized Error":c=b.authorized_err;break;case"Generic Authorization Error":c=b.generic_err;break;case"Internal Authorization Error":c=b.internal_err}return c}var H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb;(N=d.$pdk)&&(H="auth",I="728",J="970",K="300",L=3e4,M=new RegExp(["ad_(",I,"|",J,")x\\d{2,3}_\\d{1}"].join(""),"gi"),O=c.analytics?c.analytics:{authzTrack:a.noop},P=i.toBoolean(o.largePlayer),Q=i.toBoolean(o.live),R=o.mpxId,S=!Q&&R&&R.split("/").pop(),_=o.episodeRating,ab=o.episodeTitle,bb=o.mpxGuid,V=i.toBoolean(o.leaderboardAdsEnabled),Y=b("#dart-tag-wrapper"),X=b(".tve-leaderboard-ads"),$=b("#leaderboard-ads-area-wrapper"),Z=b("#leaderboard-ads-area"),W=!1,cb=null,m.isEntitled=o.entitlement===H,m.isMobile=i.device.isMobile,m.showPlayer=u(),m.showLeaderboard=!0,m.showDartAdd=!0,m.showLeaderboardAdd=!1,m.showCompanionAdd=!1,m.showAssetDetails=!0,m.showWatchwithSideCar=!1,m.hideSideCarErrorMessage=!1,m.isLivePlayerRefreshSlate=!1,m.showLivePlayerSlateTimer=null,m.user={isAuthenticated:f.isAuthenticated()},m.isLive=Q,m.isPlayerLoading=!1,f.promise.then(function(a){T=a,m.user.isAuthenticated=a.isAuthenticated,Drupal.settings.enableRefreshSlate&&m.showPlayer&&!a.isAuthenticated&&v(),a.isAuthenticated&&"auth"==o.entitlement&&p(),(m.showPlayer=u())&&(m.isPlayerLoading=!0)}),k(function(){c.watchwith&&c.watchwith.loadSideCar(),x()},0),m.openLoginWindow=f.openLoginModal,m.play=function(){m.previouslyWatched=null,N.controller.clickPlayButton(!0)},m.showWatchwithSidecar=function(){m.showWatchwithSideCar=!0},m.showAboutSection=function(){m.showWatchwithSideCar=!1},c.watchwith&&(c.watchwith.showSideCarTabs=function(){f.promise.then(function(){u()&&(m.showSideCarTabs=!0,m.hideSideCarErrorMessage=!0,m.showWatchwithSideCar=!0)})}),"undefined"!=typeof Drupal.settings.tve_cookie_detection&&0==Drupal.settings.tve_cookie_detection.status&&"auth"==o.entitlement&&f.isAuthenticated()&&j.open({controller:"ThirdPartyCookieCtrl",windowClass:"thirdPartyCookieNotify tveModal tveModalBx",templateUrl:"third-party-cookie-notification.html",keyboard:!0,backdrop:"static"}))}}}])}(angular,jQuery,tve,this),function(a,b){a.module("tve.directives").directive("tveAnimatedPng",[function(){return{link:function(c,d,e){function f(b){var f,g,h=new Image,i=0;h.src=b,h.onload=function(){function b(){i=(i-f)%l,d.css("background-position","0 "+i+"px")}function j(){clearInterval(g),d.css("background-position","0 0")}var l=k(h.height);f=k(h.width),d.css({width:f,height:f}),c.$watch(a.isDefined(e.ngShow)?e.ngShow:e.loading,function(a){a?g=setInterval(b,30):j()}),c.$on("$destroy",j)}}function g(c){var d,e=[null,":after",":before"];try{a.forEach(e,function(a){if(d=b.getComputedStyle(c,a).getPropertyValue("background-image"),d&&"none"!==d)throw new Error})}catch(f){}return d}function h(a){var b=a.match(/^url\(['"]?([^'"]+)['"]?\)$/);return b&&b[1]}function i(a){var b="data:image/";return a?a.substr(0,b.length)===b:null}function j(a){var b="";if(a)try{b=i(a)?a.split(";").shift().split("/").pop():a.split(".").pop()}catch(c){}return b}function k(a){return parseInt(a,10)}var l="gif",m=d[0];c.$evalAsync(function(){var a=g(m),b=h(a);j(b)!=l&&b&&f(b)})}}}])}(angular,this);