<?php
/**
 * @file
 * Code for the USA Network Umbel Tracking.
 */

/**
 * Implementation of hook_menu().
 */
function usanetwork_umbel_menu() {
  // admin area
  $items['admin/usanetwork/umbel'] = array(
    'title' => 'Umbel Tracking settings',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('usanetwork_umbel_tracking_admin_settings'),
    'access arguments' => array('administer site configuration'),
    'file' => 'usanetwork_umbel.admin.inc',
  );
  return $items;
}


///**
// * Implements hook_init().
// */
//function usanetwork_umbel_init() {
//  drupal_add_js('_satellite.pageBottom();', array('type' => 'inline', 'scope' => 'footer', 'every_page' => TRUE, 'preprocess' => FALSE));
//}

/**
 * Implements hook_page_alter().
 */
function usanetwork_umbel_alter(&$page) {

  $footer = '_umbel.push({"type":"send","name":"action.tag","value": ["<Show Name>","<Content Type>", "<Title>"]});';
  
//  if ($omniture_hooked_vars = module_invoke_all('omniture_variables')) {
//    if (isset($omniture_hooked_vars['header'])) {
//      $header = $omniture_hooked_vars['header'];
//    }
//    if (isset($omniture_hooked_vars['variables'])) {
//      $extra_variables_formatted .= _omniture_format_variables($omniture_hooked_vars['variables']);
//    }
//    if (isset($omniture_hooked_vars['footer'])) {
//      $footer = $omniture_hooked_vars['footer'];
//    }
//  }

  $page['page_bottom']['umbel'] =  array(
//    'variables'=> array(
//      '#type' => 'markup',
//      '#markup' => $extra_variables_formatted,
//    ),
    'footer'=> array(
      '#type' => 'markup',
      '#markup' => $footer,
    ),
  );
}
